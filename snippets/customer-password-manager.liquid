<div id="customer-password-manager" class="max-w-xl mx-auto p-6 bg-[#FCFBF7] rounded-lg shadow-md">
  <h2 class="text-2xl font-semibold text-[#514849] mb-4">Manage Your Password</h2>

  {% if customer %}
    <!-- Logged In: Change Password Form -->
    <form id="change-password-form" method="post" action="/account" class="grid grid-cols-1 gap-4">
      <input type="hidden" name="form_type" value="customer_update">
      <input type="hidden" name="utf8" value="✓">

      <div>
        <label class="block text-[#514849] text-lg mb-2 font-medium">Current Password*</label>
        <input
          type="password"
          name="current_password"
          placeholder="Enter current password"
          class="w-full text-lg text-[#797375] placeholder:text-[#797375] border border-[#E3E2E0] py-3 px-4 rounded-lg"
          required
        >
      </div>

      <div>
        <label class="block text-[#514849] text-lg mb-2 font-medium">New Password*</label>
        <input
          type="password"
          name="password"
          placeholder="Enter new password"
          class="w-full text-lg text-[#797375] placeholder:text-[#797375] border border-[#E3E2E0] py-3 px-4 rounded-lg"
          required
        >
      </div>

      <div>
        <label class="block text-[#514849] text-lg mb-2 font-medium">Confirm New Password*</label>
        <input
          type="password"
          name="password_confirmation"
          placeholder="Confirm new password"
          class="w-full text-lg text-[#797375] placeholder:text-[#797375] border border-[#E3E2E0] py-3 px-4 rounded-lg"
          required
        >
      </div>

      <div>
        <button type="submit" class="btn !py-3 !px-6 bg-[#1E6C44] text-white rounded-lg">Update Password</button>
      </div>
    </form>

  {% else %}
    <!-- Logged Out: Send Reset Link Form -->
    <p class="text-base text-[#797375] mb-4">Forgot your password? Enter your email below to receive a reset link.</p>
    <form id="recover-password-form" method="post" action="/account/recover" class="grid grid-cols-1 gap-4">
      <input type="hidden" name="form_type" value="recover_customer_password">
      <input type="hidden" name="utf8" value="✓">

      <div>
        <label for="customer-email" class="block text-[#514849] text-lg mb-2 font-medium">Email*</label>
        <input
          id="customer-email"
          name="email"
          type="email"
          placeholder="Enter your email"
          class="w-full text-lg text-[#797375] placeholder:text-[#797375] border border-[#E3E2E0] py-3 px-4 rounded-lg"
          required
        >
      </div>

      <div>
        <button type="submit" class="btn !py-3 !px-6 bg-[#1E6C44] text-white rounded-lg">Send Reset Link</button>
      </div>
    </form>
  {% endif %}
</div>

<!-- Toast Notification -->
<div
  id="toast"
  class="fixed bottom-5 right-5 bg-[#1E6C44] text-white px-6 py-3 rounded-lg shadow-lg opacity-0 transition-opacity duration-300 z-50"
></div>

<script>
  document.addEventListener("DOMContentLoaded", function() {
    function showToast(message) {
      const toast = document.getElementById("toast");
      toast.textContent = message;
      toast.classList.remove("opacity-0");
      toast.classList.add("opacity-100");
      setTimeout(() => {
        toast.classList.remove("opacity-100");
        toast.classList.add("opacity-0");
      }, 3000);
    }

    {% if customer %}
    // Logged in: show toast after password update
    const changeForm = document.getElementById("change-password-form");
    changeForm.addEventListener("submit", function(e) {
      setTimeout(() => showToast("Password updated successfully!"), 500);
    });
    {% else %}
    // Logged out: show toast after send reset link
    const recoverForm = document.getElementById("recover-password-form");
    recoverForm.addEventListener("submit", function(e) {
      setTimeout(() => showToast("Check your email for the reset link!"), 500);
    });
    {% endif %}
  });
</script>
