<div id="customer-password-manager" class="max-w-xl mx-auto p-6 bg-[#FCFBF7] rounded-lg shadow-md">
  <h2 class="text-2xl font-semibold text-[#514849] mb-4">Manage Your Password</h2>

  {% if customer %}
    <!-- Logged In: Redirect to Recover Page -->
    <form id="redirect-recover-form" class="grid grid-cols-1 gap-4">
      <div>
        <label class="block text-[#514849] text-lg mb-2 font-medium">Current Password (for reference)*</label>
        <input
          type="password"
          name="current_password"
          placeholder="Enter current password"
          class="w-full text-lg text-[#797375] placeholder:text-[#797375] border border-[#E3E2E0] py-3 px-4 rounded-lg"
        >
      </div>

      <div>
        <button type="submit" class="btn !py-3 !px-6 bg-[#1E6C44] text-white rounded-lg">Set New Password</button>
      </div>
    </form>

    {% form 'customer' %}
      {{ form.errors | default_errors }}

      <div class="field">
        <label for="password">New Password</label>
        <input type="password" name="customer[password]" id="password" required>
      </div>

      <div class="field">
        <label for="password_confirmation">Confirm New Password</label>
        <input type="password" name="customer[password_confirmation]" id="password_confirmation" required>
      </div>

      <button type="submit" class="btn">Change Password</button>
    {% endform %}

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const form = document.getElementById('redirect-recover-form');
        form.addEventListener('submit', function (e) {
          e.preventDefault();
          // Logged-in customer redirected to recover page
          window.location.href = '/account/logout?return_url=/account/login#recover';
        });
      });
    </script>

  {% else %}
    <!-- Logged Out: Send Reset Link Form -->
    <p class="text-base text-[#797375] mb-4">Forgot your password? Enter your email below to receive a reset link.</p>
    <form
      id="recover-password-form"
      method="post"
      action="{{routes.account_recover_url}}"
      class="grid grid-cols-1 gap-4"
    >
      <input type="hidden" name="form_type" value="recover_customer_password">
      <input type="hidden" name="utf8" value="âœ“">

      <div>
        <label for="customer-email" class="block text-[#514849] text-lg mb-2 font-medium">Email*</label>
        <input
          id="customer-email"
          name="email"
          type="email"
          placeholder="Enter your email"
          class="w-full text-lg text-[#797375] placeholder:text-[#797375] border border-[#E3E2E0] py-3 px-4 rounded-lg"
          required
        >
      </div>

      <div>
        <button type="submit" class="btn !py-3 !px-6 bg-[#1E6C44] text-white rounded-lg">Send Reset Link</button>
      </div>
    </form>
  {% endif %}
</div>
