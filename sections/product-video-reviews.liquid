{% if product.metafields.custom.video_reviews != blank %}
  <div class="our-customer py-15 md:py-20 lg:py-37.5">
    <div class="container !max-w-[1220px] mx-auto px-4">
      <div class="our-customer-wrapper">
        <div class="section-title text-center mb-12">
          <h2 class="title text-3xl lg:text-[44px] font-bold text-[#0D2E1D] font-armany-bold leading-tight mb-4">
            {{ section.settings.heading }}
          </h2>
          {% if section.settings.subheading != blank %}
            <p class="description text-[#797375] text-base md:text-lg lg:text-xl leading-[1.6] font-poppins">
              {{ section.settings.subheading }}
            </p>
          {% endif %}
        </div>

        <div class="relative z-1">
          <div class="swiper review-slider">
            <div class="swiper-wrapper">
              {% for video_url in product.metafields.custom.video_reviews.value %}
                {% assign video_id = video_url | split: 'v=' | last %}
                <div class="swiper-slide">
                  <div class="rounded-[10px]">
                    <div class="relative w-full h-75 md:h-[400px] lg:h-[500px] xl:h-[600px]">
                      <div class="w-full h-full bg-gray-200 rounded-xl overflow-hidden relative">
                        <iframe
                          class="w-full h-full rounded-xl"
                          src="https://www.youtube.com/embed/{{ video_id }}?rel=0&modestbranding=1&playsinline=1"
                          title="Customer Video Review"
                          frameborder="0"
                          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                          allowfullscreen
                        ></iframe>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>

          <!-- Navigation -->
          <div
            class="absolute md:block w-full xl:w-[calc(100%+76px)] z-1 left-0 top-1/2 -translate-y-1/2 lg:flex items-center gap-4 ml-0 xl:-ml-9"
          >
            <div class="swiper-button-prev bg-[#FFE380] !text-[#0D2E1D] hover:!text-black !size-10 md:!size-14 rounded-full flex items-center justify-center">
              <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M6.66797 1L1.16797 6.5M1.16797 6.5L6.66797 12M1.16797 6.5L15.8346 6.5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
            <div class="swiper-button-next bg-[#FFE380] !text-[#0D2E1D] hover:!text-black !size-10 md:!size-14 rounded-full flex items-center justify-center">
              <svg width="17" height="13" viewBox="0 0 17 13" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M10.332 1L15.832 6.5M15.832 6.5L10.332 12M15.832 6.5L1.16536 6.5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      new Swiper('.review-slider', {
        loop: true,
        speed: 700,
        navigation: {
          prevEl: '.swiper-button-prev',
          nextEl: '.swiper-button-next',
        },
        grabCursor: true,
        effect: 'slide',
        breakpoints: {
          320: { slidesPerView: 1.2, spaceBetween: 10 },
          640: { slidesPerView: 2, spaceBetween: 20 },
          1024: { slidesPerView: 3, spaceBetween: 30 },
        },
      });
    });
  </script>
{% endif %}

{% schema %}
{
  "name": "Product Video Reviews",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Title",
      "default": "Hear Directly From Our Customers"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Section Subtitle",
      "default": "Real experiences, real stories. Watch how our customers share their experiences."
    }
  ],
  "presets": [
    {
      "name": "Product Video Reviews"
    }
  ]
}
{% endschema %}
