{% stylesheet %}
  .header-social-item svg {
    max-width: 18px;
  }
{% endstylesheet %}

<div class="topbar bg-[#FFD500] text-black text-sm py-2 px-0 lg:px-6">
  <div class="container">
    <div class="topbar-inner flex justify-between items-center">
      <!-- Left: Social -->
      <div class="flex items-center gap-2">
        <span class="text-[#21201E] text-sm lg:text-lg leading-normal">Follow Us</span>
        {% for block in section.blocks %}
          {% if block.type == 'social' %}
            <a
              href="{{ block.settings.url }}"
              class=" w-6 lg:w-9 h-6 lg:h-9 bg-[#FFE380] header-social-item rounded-3xl flex items-center justify-center hover:bg-white transition-all duration-300 p-1 text-xl"
              aria-label="{{ block.settings.platform }}"
            >
              {% case block.settings.platform %}
                {% when 'instagram' -%}
                  {%- render 'icon-instagram' %}
                {% when 'twitter' -%}
                  {%- render 'icon-twitter' %}
                {% when 'facebook' -%}
                  {%- render 'icon-facebook' %}
                {% when 'youtube' -%}
                  {%- render 'icon-youtube' %}
                {% when 'linkedin' -%}
                  {%- render 'icon-linkedin' %}
                {% when 'tiktok' -%}
                  {%- render 'icon-tiktok' %}
              {% endcase %}
            </a>
          {% endif %}
        {% endfor %}
      </div>

      <!-- Center: Offer Text -->
      {% if section.settings.offer_text != blank %}
        <p class="hidden md:!block text-lg leading-normal text-[#21201E]">
          {{ section.settings.offer_text }}
        </p>
      {% endif %}

      <!-- Right: Phone -->
      {% if section.settings.phone_number != blank %}
        <div class="flex items-center gap-2">
          <a
            href="tel:{{ section.settings.phone_number -}}"
            class="flex items-center gap-1 text-[#21201E] text-xs lg:text-lg font-poppins"
          >
            {% render 'icon-phone' %}
            {{ section.settings.phone_number -}}
          </a>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<!-- Main Header -->
<header class="main-header bg-[#1E6B43] text-white py-4 px-0 md:px-2 lg:px-6 z-10">
  <div class="container">
    <div class="header-inner flex justify-between items-center">
      <!-- Mobile Menu Toggle -->
      <button
        id="menuToggle"
        class="md:hidden text-white text-2xl cursor-pointer hover:scale-105 transition-all duration-300"
        aria-label="Open Menu"
      >
        {% render 'icon-hamburger' %}
      </button>

      <!-- Logo -->
      <div class="site-logo">
        <a href="{{ routes.root_url }}">
          {% if section.settings.logo != blank %}
            <img
              src="{{ section.settings.logo | image_url: width: 200 }}"
              alt="{{ shop.name }}"
              class="w-full max-w-20 lg:max-w-44"
              width=""
              height=""
            >
          {% else %}
            <span class="text-lg lg:text-3xl font-bold font-serif tracking-wide">Roots</span>
          {% endif %}
        </a>
      </div>

      <!-- Desktop Menu -->
      {% assign main_menu = section.settings.menu | default: linklists['main-menu'] %}
      <nav id="desktopMenu" class="hidden md:!flex gap-5 lg:gap-10">
        {% for link in main_menu.links %}
          <a
            href="{{ link.url }}"
            class="menu-link text-lg text-white font-poppins relative z-1 hover:text-[#FFD500] transition duration-300 before:absolute before:w-full before:h-[2px] before:rounded-3xl before:bg-primary before:-bottom-2 before:left-0 before:opacity-0"
          >
            {{ link.title }}
          </a>
        {% endfor %}
      </nav>

      <!-- Right Icons -->
      <div class="flex items-center gap-2 md:gap-4">
        <a
          href="{{ routes.cart_url }}"
          class="relative text-white hover:text-primary transition-all duration-300 flex items-center gap-1.5"
        >
          {% render 'icon-cart' %}
          <sup class="cart-count absolute -top-1 left-3 bg-primary text-black rounded-full text-xs px-1">
            {{ cart.item_count }}
          </sup>
          Cart
        </a>
        {% if customer %}
          <a
            href="{{ routes.account_url }}"
            class="text-white transition-all text-base lg:text-lg duration-300 flex items-center gap-1 md:border border-solid border-[#929090] rounded-full md:p-2 md:pr-3 hover:border-primary"
          >
            {% render 'icon-user' %}
            <span class="md:!block hidden">Account</span>
          </a>
        {% else %}
          <a
            href="{{ routes.account_register_url }}"
            class="bg-primary text-[#1F1904] px-3 md:px-6 py-2.5 rounded-full font-poppins text-sm lg:text-lg font-medium transition-all duration-300 hover:bg-white"
          >
            Sign Up
          </a>
        {% endif %}
      </div>
    </div>
  </div>
</header>

<!-- Offcanvas Mobile Menu -->
<div
  id="mobileMenu"
  class="fixed inset-0 bg-black/50 left-0 top-0 hidden z-50 cursor-pointer opacity-0 transition-opacity duration-300"
>
  <div
    id="mobileMenuPanel"
    class="bg-white w-64 h-full p-6 flex flex-col transform -translate-x-full transition-transform duration-300"
  >
    <div class="site-logo absolute left-4 top-5">
      <a href="{{ routes.root_url }}">
        {% if section.settings.logo != blank %}
          <img src="{{ section.settings.logo | image_url: width: 200 }}" alt="{{ shop.name }}" class="max-h-12 w-auto">
        {% else %}
          <span class="text-3xl font-bold font-serif tracking-wide">Roots</span>
        {% endif %}
      </a>
    </div>
    <button id="menuClose" class="self-end mb-6 text-xl cursor-pointer hover:scale-[1.05] transition-all duration-300">
      âœ•
    </button>
    {% for link in section.settings.menu.links %}
      <a href="{{ link.url }}" class="block py-4 text-lg border-b hover:text-primary transition-all duration-300">
        {{- link.title -}}
      </a>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "Header Top & Bottom",
  "settings": [
    { "type": "text", "id": "offer_text", "label": "Offer text", "default": "Sign up get 20% Off for all collection" },
    { "type": "text", "id": "phone_number", "label": "Phone number", "default": "1 (100) 234-5678" },
    { "type": "link_list", "id": "menu", "label": "Navigation Menu" },
    { "type": "image_picker", "id": "logo", "label": "Logo" }
  ],
  "blocks": [
    {
      "type": "social",
      "name": "Social Icon",
      "settings": [
        {
          "type": "select",
          "id": "platform",
          "label": "Platform",
          "options": [
            { "value": "instagram", "label": "Instagram" },
            { "value": "twitter", "label": "Twitter" },
            { "value": "facebook", "label": "Facebook" },
            { "value": "youtube", "label": "YouTube" },
            { "value": "linkedin", "label": "LinkedIn" },
            { "value": "tiktok", "label": "TikTok" }
          ],
          "default": "instagram"
        },
        { "type": "url", "id": "url", "label": "Profile URL" }
      ]
    }
  ],
  "max_blocks": 10
}
{% endschema %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const menuToggle = document.getElementById('menuToggle');
    const mobileMenu = document.getElementById('mobileMenu');
    const menuPanel = document.getElementById('mobileMenuPanel');
    const menuClose = document.getElementById('menuClose');

    function openMenu() {
      mobileMenu.classList.remove('hidden');
      setTimeout(() => {
        mobileMenu.classList.remove('opacity-0');
        menuPanel.classList.remove('-translate-x-full');
      }, 20);
    }

    function closeMenu() {
      mobileMenu.classList.add('opacity-0');
      menuPanel.classList.add('-translate-x-full');
      setTimeout(() => {
        mobileMenu.classList.add('hidden');
      }, 300);
    }

    if (menuToggle) menuToggle.addEventListener('click', openMenu);
    if (menuClose) menuClose.addEventListener('click', closeMenu);
    if (mobileMenu) {
      mobileMenu.addEventListener('click', (e) => {
        if (e.target === mobileMenu) closeMenu();
      });
    }

    // Desktop active menu highlight
    const links = document.querySelectorAll('#desktopMenu .menu-link');
    const currentPath = window.location.pathname.replace(/\/$/, '');
    links.forEach((link) => {
      const linkPath = link.getAttribute('href').replace(/\/$/, '');
      if (currentPath === linkPath) {
        link.classList.add('active', 'before:opacity-100');
      }
    });
  });
</script>
